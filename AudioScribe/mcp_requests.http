@audio_uri = http://localhost:9999/audio.wav

# For Docker:
#@audio_uri = http://host.docker.internal:9999/15minRecording.flac


@mcp_protocol_version = 2024-11-05

# Streamable HTTP mcp_session_id is returned in 'mcp-session-id' response header after below 'initialize' request
# Update below ID after each initialize request
@mcp_session_id = CHANGE_ME

# Paste the messages path you received in the very first SSE event here.
# Update below ID after each initialize request
@sse_messages_path = /sse-root/messages/?session_id=CHANGE_ME


###
# @name initialize
# Initialize a Streamable HTTP MCP session.
# IMPORTANT:
# - After you send this, copy the "mcp-session-id" response header value
#   into the mcp_session_id variable below.
# - Keep the protocolVersion consistent across requests; copy it to
#   mcp_protocol_version.
POST http://localhost:7016/mcp
Content-Type: application/json
Accept: application/json, text/event-stream

{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "initialize",
  "params": {
    "protocolVersion": "2024-11-05",
    "capabilities": {},
    "clientInfo": { "name": "http-client", "version": "0.1.0" }
  }
}

###
# @name list_tools
# List available tools. Requires session headers from initialization.
POST http://localhost:7016/mcp
Content-Type: application/json
Accept: application/json, text/event-stream
MCP-Session-Id: {{mcp_session_id}}
MCP-Protocol-Version: {{mcp_protocol_version}}

{
  "jsonrpc": "2.0",
  "id": 2,
  "method": "tools/list",
  "params": {}
}

###
# @name transcribe_local
# Transcribe an audio file using a local faster-whisper model via tools/call.
POST http://localhost:7016/mcp
Content-Type: application/json
Accept: application/json, text/event-stream
MCP-Session-Id: {{mcp_session_id}}
MCP-Protocol-Version: {{mcp_protocol_version}}

{
  "jsonrpc": "2.0",
  "id": 3,
  "method": "tools/call",
  "params": {
    "name": "transcribe_local",
    "arguments": {
      "audio_uri": "{{audio_uri}}",
      "model": "Systran/faster-whisper-large-v3",
      "language": "en",
      "with_timestamps": false
    }
  }
}


###
# @name transcribe_local_with_timestamps
# Transcribe using local model and return timestamped segments (Streamable HTTP).
POST http://localhost:7016/mcp
Content-Type: application/json
Accept: application/json, text/event-stream
MCP-Session-Id: {{mcp_session_id}}
MCP-Protocol-Version: {{mcp_protocol_version}}

{
  "jsonrpc": "2.0",
  "id": 7,
  "method": "tools/call",
  "params": {
    "name": "transcribe_local",
    "arguments": {
      "audio_uri": "{{audio_uri}}",
      "model": "Systran/faster-whisper-large-v3",
      "language": "en",
      "with_timestamps": true
    }
  }
}

###
# @name transcribe_openai
# Transcribe an audio file using the OpenAI API via tools/call.
POST http://localhost:7016/mcp
Content-Type: application/json
Accept: application/json, text/event-stream
MCP-Session-Id: {{mcp_session_id}}
MCP-Protocol-Version: {{mcp_protocol_version}}

{
  "jsonrpc": "2.0",
  "id": 4,
  "method": "tools/call",
  "params": {
    "name": "transcribe_openai",
    "arguments": {
      "audio_uri": "{{audio_uri}}",
      "model": "whisper-1",
      "language": "en"
    }
  }
}

###
# @name transcribe_hf
# Transcribe an audio file using a Hugging Face provider via tools/call.
POST http://localhost:7016/mcp
Content-Type: application/json
Accept: application/json, text/event-stream
MCP-Session-Id: {{mcp_session_id}}
MCP-Protocol-Version: {{mcp_protocol_version}}

{
  "jsonrpc": "2.0",
  "id": 5,
  "method": "tools/call",
  "params": {
    "name": "transcribe_hf",
    "arguments": {
      "audio_uri": "{{audio_uri}}",
      "model": "openai/whisper-large-v3",
      "hf_provider": "hf-inference"
    }
  }
}

###
# @name health
# Simple health check via tools/call over Streamable HTTP.
POST http://localhost:7016/mcp
Content-Type: application/json
Accept: application/json, text/event-stream
MCP-Session-Id: {{mcp_session_id}}
MCP-Protocol-Version: {{mcp_protocol_version}}

{
  "jsonrpc": "2.0",
  "id": 6,
  "method": "tools/call",
  "params": {
    "name": "health",
    "arguments": {}
  }
}

###
# SSE TRANSPORT EXAMPLES
# ------------------------------------------------------------------------------------------
# The server is also exposing an SSE transport mounted under "/sse-root".
# SSE is a long-lived GET connection for server-to-client events, and a POST endpoint
# for client-to-server messages.
#
# Flow:
# 1) Start the SSE stream (GET). The first event will contain the message POST path like:
#      /sse-root/messages/?session_id=<session_id_hex>
# 2) Copy that path into the variable below and use it for JSON-RPC POSTs.
# ------------------------------------------------------------------------------------------

###
# @name sse_connect
# Start an SSE stream. Your HTTP client must support text/event-stream to keep the
# connection open and display events. If it doesn't, use curl:
#   curl -N -H "Accept: text/event-stream" http://localhost:7017/sse-root/sse
GET http://localhost:7016/sse-root/sse
Accept: text/event-stream

###
# @name sse_initialize
# Initialize the MCP session over SSE by POSTing to the messages path.
POST http://localhost:7016{{sse_messages_path}}
Content-Type: application/json

{
  "jsonrpc": "2.0",
  "id": 100,
  "method": "initialize",
  "params": {
    "protocolVersion": "2024-11-05",
    "capabilities": {},
    "clientInfo": { "name": "http-client", "version": "0.1.0" }
  }
}

###
# @name sse_list_tools
# List available tools over SSE by POSTing to the messages path.
POST http://localhost:7016{{sse_messages_path}}
Content-Type: application/json

{
  "jsonrpc": "2.0",
  "id": 110,
  "method": "tools/list",
  "params": {}
}

###
# @name sse_transcribe_local
POST http://localhost:7016{{sse_messages_path}}
Content-Type: application/json

{
  "jsonrpc": "2.0",
  "id": 101,
  "method": "tools/call",
  "params": {
    "name": "transcribe_local",
    "arguments": {
      "audio_uri": "{{audio_uri}}",
      "model": "Systran/faster-whisper-large-v3",
      "language": "en",
      "with_timestamps": false
    }
  }
}

###
# @name sse_transcribe_local_with_timestamps
POST http://localhost:7016{{sse_messages_path}}
Content-Type: application/json

{
  "jsonrpc": "2.0",
  "id": 101,
  "method": "tools/call",
  "params": {
    "name": "transcribe_local",
    "arguments": {
      "audio_uri": "{{audio_uri}}",
      "model": "Systran/faster-whisper-large-v3",
      "language": "en",
      "with_timestamps": true
    }
  }
}

###
# @name sse_transcribe_openai
POST http://localhost:7016{{sse_messages_path}}
Content-Type: application/json

{
  "jsonrpc": "2.0",
  "id": 102,
  "method": "tools/call",
  "params": {
    "name": "transcribe_openai",
    "arguments": {
      "audio_uri": "{{audio_uri}}",
      "model": "whisper-1",
      "language": "en"
    }
  }
}

###
# @name sse_transcribe_hf
POST http://localhost:7016{{sse_messages_path}}
Content-Type: application/json

{
  "jsonrpc": "2.0",
  "id": 103,
  "method": "tools/call",
  "params": {
    "name": "transcribe_hf",
    "arguments": {
      "audio_uri": "{{audio_uri}}",
      "model": "openai/whisper-large-v3",
      "hf_provider": "hf-inference"
    }
  }
}

###
# @name sse_health
# Simple health check via tools/call over SSE.
POST http://localhost:7016{{sse_messages_path}}
Content-Type: application/json

{
  "jsonrpc": "2.0",
  "id": 111,
  "method": "tools/call",
  "params": {
    "name": "health",
    "arguments": {}
  }
}
